<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Sistema de gestión de prospectos y seguimiento de eventos para JASSO">
	<meta name="author" content="JASSO">
	<meta name="keywords" content="jasso, eventos, bodas, xv años, gestión, prospectos, seguimiento, cotizaciones, paquetes, salón de eventos">
	

    <title>Inicio | JASSO</title>
    <link rel="shortcut icon" href="img/icons/icon-48x48.png" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="css/app.css" rel="stylesheet">
    <link rel="stylesheet" href="css/loading.css">

    <link rel="stylesheet" href="css/notificaciones.css">
    <link rel="stylesheet" href="css/userPic.css">
    <link rel="stylesheet" href="css/inicio/inicio.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
 
<!-- En el head de tu HTML -->
<link href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bootstrap-4/bootstrap-4.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

      <!-- Open Graph Meta Tags for WhatsApp Preview -->
      <meta property="og:title" content="Paquetes JASSO">
      <meta property="og:description" content="Descubre nuestros increíbles paquetes para eventos">
      <meta property="og:image" content="https://jassocompany.com/img/logo.jpg">
      <meta property="og:url" content="https://jassocompany.com/paquete-detalle.html">
      <meta property="og:type" content="website">
      <meta property="og:site_name" content="JASSO">
  
      <!-- WhatsApp specific meta -->
      <meta property="og:image:width" content="600">
      <meta property="og:image:height" content="315">

   
</head>
<body>
    <div id="loader" class="loader-container">
        <div class="loader-content">
            <div class="loader"></div>
        </div>
    </div>
    <div class="wrapper">
        <nav id="sidebar" class="sidebar js-sidebar">
            <!-- Sidebar content -->
        </nav>

        <div class="main">
          <nav class="navbar navbar-expand navbar-light navbar-bg">
            <a class="sidebar-toggle js-sidebar-toggle">
              <i class="hamburger align-self-center"></i>
            </a>
  
            <div class="navbar-collapse collapse">
              <ul class="navbar-nav navbar-align">
                <li class="nav-item dropdown">
                  <a class="nav-icon dropdown-toggle" href="#" id="alertsDropdown" data-bs-toggle="dropdown">
                    <div class="position-relative">
                      <i class="align-middle" data-feather="bell"></i>
                      <span class="indicator" id="notificationCount">0</span>
                    </div>
                  </a>
                 <!-- Update the notification list container in your HTML -->
<div class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0" aria-labelledby="alertsDropdown">
  <div class="dropdown-menu-header" id="notificationHeader">0 Nuevas Notificaciones</div>
  <div class="list-group" id="notificationList">
    <!-- Notifications will be inserted here -->
  </div>
  <div class="dropdown-menu-footer">
    <a href="all-notifications.html" class="text-muted">Ver todas las notificaciones</a>
  </div>
</div>
                </li>
            
                <li class="nav-item dropdown">
                  <a
                    class="nav-icon dropdown-toggle d-inline-block d-sm-none"
                    href="#"
                    data-bs-toggle="dropdown"
                  >
                    <i class="align-middle" data-feather="settings"></i>
                  </a>
  
                  <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                    <span id="imgPerfil" class="avatar-container"></span>
                    <span class="text-dark" id="nombreUsuario"></span>
                </a>
                    <div class="dropdown-menu dropdown-menu-end">
                      <a class="dropdown-item" href="pages-profile.html"
                        ><i class="align-middle me-1" data-feather="user"></i>
                        Profile</a
                      >
                      <a class="dropdown-item" href="#"
                        ><i
                          class="align-middle me-1"
                          data-feather="pie-chart"
                        ></i>
                        Analytics</a
                      >
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item" href="index.html"
                        ><i class="align-middle me-1" data-feather="settings"></i>
                        Settings & Privacy</a
                      >
                      <a class="dropdown-item" href="#"
                        ><i
                          class="align-middle me-1"
                          data-feather="help-circle"
                        ></i>
                        Help Center</a
                      >
                      <div class="dropdown-divider"></div>
                      <a id="logOut" class="dropdown-item" href="#"
                        >Cerrar sesion</a
                      >
                    </div>
                  </a>
                </li>
              </ul>
            </div>
          </nav>

          <main class="content">
      
           
<button class="search-float-button" id="openSearchModal">
  <i class="fas fa-search"></i>
</button>


<div class="search-modal" id="searchModal">
  <div class="search-modal-content">
   
    <div class="search-modal-header">
      <div class="search-input-container">
        <i class="fas fa-search"></i>
        <input type="text" id="searchInput" placeholder="Buscar paquetes...">
      </div>
      <button class="close-modal" id="closeSearchModal">
        <i class="fas fa-times"></i>
      </button>
    </div>

   
    <div class="filters-toggle">
      <button id="toggleFilters">
        <i class="fas fa-filter"></i> Filtros avanzados
      </button>
    </div>

    
    <div class="filters-container" id="filtersContainer" style="display: none;">
      <div class="filter-group">
        <select id="categoriaFilter">
          <option value="">Categoría</option>
        </select>
      </div>
      <div class="filter-group">
        <select id="lugarFilter">
          <option value="">Ubicación</option>
        </select>
      </div>
      <div class="filter-group price-range">
        <input type="number" id="minPrice" placeholder="Precio mínimo">
        <input type="number" id="maxPrice" placeholder="Precio máximo">
      </div>
      <div class="filter-group">
        <label class="promo-filter">
          <input type="checkbox" id="promoFilter">
          Solo promociones
        </label>
      </div>
    </div>

    <div class="search-results" id="searchResults">
     
    </div>
  </div>
</div>


            <div class="container-fluid p-0">
             
                <!-- Carrusel tipo Netflix para populares -->
                <div class="featured-carousel">
                    <div class="featured-slides" id="featured-container"></div>
                    <div class="featured-controls">
                        <button class="featured-prev"><i class="fas fa-chevron-left"></i></button>
                        <button class="featured-next"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="featured-indicators" id="featured-indicators"></div>
                </div>
        
                <!-- Carrusel horizontal para publicaciones recientes -->
                <div class="carousel-container">
                    <h2>Publicaciones Recientes</h2>
                    <div class="posts-carousel" id="popular-posts-container"></div>
                </div>
            </div>
        </main>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/sesion-checked.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/inicio/inicioPrueba.js"></script>

    <script>
class SearchModal {
  constructor() {
    this.db = firebase.firestore();
    this.publicaciones = [];
    this.initializeElements();
    this.setupEventListeners();
    this.loadPublicaciones();
  }

  initializeElements() {
    this.modal = document.getElementById('searchModal');
    this.openButton = document.getElementById('openSearchModal');
    this.closeButton = document.getElementById('closeSearchModal');
    this.searchInput = document.getElementById('searchInput');
    this.filtersToggle = document.getElementById('toggleFilters');
    this.filtersContainer = document.getElementById('filtersContainer');
    this.resultsContainer = document.getElementById('searchResults');
    this.categoriaFilter = document.getElementById('categoriaFilter');
    this.lugarFilter = document.getElementById('lugarFilter');
    this.minPrice = document.getElementById('minPrice');
    this.maxPrice = document.getElementById('maxPrice');
    this.promoFilter = document.getElementById('promoFilter');
  }

  setupEventListeners() {
    this.openButton.addEventListener('click', () => this.openModal());
    this.closeButton.addEventListener('click', () => this.closeModal());
    this.searchInput.addEventListener('input', () => this.handleSearch());
    this.filtersToggle.addEventListener('click', () => this.toggleFilters());
    
    // Eventos adicionales para filtros
    this.categoriaFilter.addEventListener('change', () => this.handleSearch());
    this.lugarFilter.addEventListener('change', () => this.handleSearch());
    this.minPrice.addEventListener('input', () => this.handleSearch());
    this.maxPrice.addEventListener('input', () => this.handleSearch());
    this.promoFilter.addEventListener('change', () => this.handleSearch());
  }

  openModal() {
    this.modal.style.display = 'block';
    document.body.style.overflow = 'hidden'; // Previene el scroll
    this.searchInput.focus();
  }

  closeModal() {
    this.modal.style.display = 'none';
    document.body.style.overflow = ''; // Restaura el scroll
  }

  toggleFilters() {
    const isHidden = this.filtersContainer.style.display === 'none';
    this.filtersContainer.style.display = isHidden ? 'block' : 'none';
  }

  populateFilters() {
    // Obtener valores únicos
    const categorias = [...new Set(this.publicaciones.map(p => p.categoria))];
    const lugares = [...new Set(this.publicaciones.map(p => p.lugar))];

    // Poblar categorías
    categorias.forEach(categoria => {
      const option = document.createElement('option');
      option.value = categoria;
      option.textContent = categoria;
      this.categoriaFilter.appendChild(option);
    });

    // Poblar lugares
    lugares.forEach(lugar => {
      const option = document.createElement('option');
      option.value = lugar;
      option.textContent = lugar;
      this.lugarFilter.appendChild(option);
    });
  }

  handleSearch() {
    const searchTerm = this.searchInput.value.toLowerCase();
    const categoria = this.categoriaFilter.value;
    const lugar = this.lugarFilter.value;
    const minPrice = this.minPrice.value ? parseFloat(this.minPrice.value) : 0;
    const maxPrice = this.maxPrice.value ? parseFloat(this.maxPrice.value) : Infinity;
    const soloPromos = this.promoFilter.checked;

    const results = this.publicaciones.filter(post => {
      const matchesSearch = post.titulo.toLowerCase().includes(searchTerm);
      const matchesCategoria = !categoria || post.categoria === categoria;
      const matchesLugar = !lugar || post.lugar === lugar;
      const matchesPrice = post.precio >= minPrice && post.precio <= maxPrice;
      const matchesPromo = !soloPromos || post.isPromocion;

      return matchesSearch && matchesCategoria && matchesLugar && matchesPrice && matchesPromo;
    });

    this.renderResults(results);
  }

  async loadPublicaciones() {
    try {
      const snapshot = await this.db.collection('publicaciones2').get();
      this.publicaciones = snapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      this.populateFilters();
    } catch (error) {
      console.error('Error loading publicaciones:', error);
    }
  }

  async renderResults(results) {
    // Obtener el tipo de usuario actual
    const user = firebase.auth().currentUser;
    let userType = 'usuario'; // tipo por defecto

    if (user) {
      try {
        const userDoc = await firebase.firestore()
          .collection('usuarios')
          .doc(user.uid)
          .get();
        
        if (userDoc.exists) {
          userType = userDoc.data().tipo || 'usuario';
        }
      } catch (error) {
        console.error('Error al obtener tipo de usuario:', error);
      }
    }

    if (results.length === 0) {
      this.resultsContainer.innerHTML = `
        <div class="no-results">
          <i class="fas fa-search"></i>
          <p>No se encontraron resultados</p>
        </div>
      `;
      return;
    }

    this.resultsContainer.innerHTML = results.map(post => `
      <div class="result-card" onclick="window.location.href='publicaciones/casaAntiguaAteaga.html?id=${post.id}&tipo=${userType}'">
        <div class="result-image-container">
          <img src="${post.imagen_destacada || 'ruta/imagen-default.jpg'}" class="result-image" alt="${post.titulo}">
          ${post.isPromocion ? 
            '<div class="promo-badge-result"><i class="fas fa-star"></i> Promoción</div>' 
            : ''}
        </div>
        <div class="result-content">
          <h3>${post.titulo}</h3>
          <div class="result-meta">
            <span><i class="fas fa-map-marker-alt"></i> ${post.lugar}</span>
            <span><i class="fas fa-tag"></i> $${post.precio.toLocaleString()}</span>
          </div>
        </div>
      </div>
    `).join('');
  }
}

// Inicializar
const searchModal = new SearchModal();
    </script>

    
</body>
</html>