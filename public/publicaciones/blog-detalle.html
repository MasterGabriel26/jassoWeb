<!DOCTYPE HTML>
<html lang="en-US">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>DreamIT- Cleaning Service HTML5 Template</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Favicon -->
	<link rel="icon" type="image/png" sizes="56x56" href="assets/images/fav-icon/icon.png">
	<!-- bootstrap CSS -->
	<link rel="stylesheet" href="./assets/css/bootstrap.min.css" type="text/css" media="all" />
	<!-- carousel CSS -->
	<link rel="stylesheet" href="./assets/css/owl.carousel.min.css" type="text/css" media="all" />
	<!-- responsive CSS -->
	<link rel="stylesheet" href="./assets/css/responsive.css" type="text/css" media="all" />
	<!-- nivo-slider CSS -->
	<link rel="stylesheet" href="./assets/css/nivo-slider.css" type="text/css" media="all" />
	<!-- animate CSS -->
	<link rel="stylesheet" href="./assets/css/animate.css" type="text/css" media="all" />
	<!-- animated-text CSS -->
	<link rel="stylesheet" href="./assets/css/animated-text.css" type="text/css" media="all" />
	<!-- font-awesome CSS -->
	<link rel="stylesheet" href="./assets/css/all.min.css" type="text/css" media="all" />
	<!-- font-flaticon CSS -->
	<link rel="stylesheet" href="./assets/css/flaticon.css" type="text/css" media="all" />
	<!-- theme-default CSS -->
	<link rel="stylesheet" href="./assets/css/theme-default.css" type="text/css" media="all" />
	<!-- meanmenu CSS -->
	<link rel="stylesheet" href="./assets/css/meanmenu.min.css" type="text/css" media="all" />

	<!-- transitions CSS -->
	<link rel="stylesheet" href="./assets/css/owl.transitions.css" type="text/css" media="all" />
	<!-- venobox CSS -->
	<link rel="stylesheet" href="./venobox/venobox.css" type="text/css" media="all" />
	<!-- widget CSS -->
	<link rel="stylesheet" href="./assets/css/widget.css" type="text/css" media="all" />
	<!-- Jquery UI CSS -->
	<link rel="stylesheet" href="./assets/css/jquery-ui.min.css" type="text/css" media="all" />
	<!-- modernizr js -->
	<!-- Main Style CSS -->
	<link rel="stylesheet" href="style.css" type="text/css" media="all" />
	<script src="./assets/js/vendor/modernizr-3.5.0.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.7.1.js"
		integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>

	<!-- Estilos base de Prism -->

	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
		rel="stylesheet" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
	<!-- CSS -->
	<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/alertify.min.css" />
	<style>
		/* Contenedor del código */
		.code-container {
			position: relative;
			margin: 1.5em 0;
			border-radius: 6px;
			overflow: hidden;
			/* Para mantener las esquinas redondeadas */
			background: #282c34;
			/* Mismo color que el fondo del código */
		}

		/* Estilos para el bloque de código */
		pre[class*="language-"] {
			background: #282c34 !important;
			color: #abb2bf !important;
			padding: 40px 16px 16px !important;
			/* Aumentado el padding superior para la etiqueta */
			margin: 0 !important;
			/* Eliminado el margen */
			font-size: 14px !important;
			font-family: Consolas, Monaco, 'Andale Mono', monospace !important;
			max-height: 400px !important;
			/* Altura máxima */
			overflow: auto !important;
			scrollbar-width: thin;
			scrollbar-color: #444c56 #282c34;
		}

		/* Estilo para scrollbars en WebKit (Chrome, Safari) */
		pre[class*="language-"]::-webkit-scrollbar {
			width: 8px;
			height: 8px;
		}

		pre[class*="language-"]::-webkit-scrollbar-track {
			background: #282c34;
		}

		pre[class*="language-"]::-webkit-scrollbar-thumb {
			background-color: #444c56;
			border-radius: 4px;
		}

		/* Etiqueta del lenguaje */
		.language-label {
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			background: #21252b;
			color: #abb2bf;
			padding: 8px 15px;
			font-size: 12px;
			font-family: 'Monaco', 'Consolas', monospace;
			border-bottom: 1px solid #181a1f;
			z-index: 2;
			/* Asegura que esté por encima del código */
		}

		/* Botón de copiar */
		.copy-button {
			position: absolute;
			top: 6px;
			right: 10px;
			background: #444c56;
			border: none;
			color: #c9d1d9;
			border-radius: 4px;
			padding: 4px 10px;
			font-size: 12px;
			cursor: pointer;
			transition: all 0.2s ease;
			opacity: 0;
			z-index: 3;
			/* Asegura que esté por encima de todo */
		}

		.code-container:hover .copy-button {
			opacity: 1;
		}

		.copy-button:hover {
			background: #545d68;
		}

		/* Estilos para tokens específicos */
		.token.comment,
		.token.prolog,
		.token.doctype,
		.token.cdata {
			color: #5c6370 !important;
			font-style: italic !important;
		}

		.token.function {
			color: #61afef !important;
		}

		.token.keyword {
			color: #c678dd !important;
		}

		.token.string {
			color: #98c379 !important;
		}

		.token.number {
			color: #d19a66 !important;
		}

		.token.operator {
			color: #56b6c2 !important;
		}

		.token.punctuation {
			color: #abb2bf !important;
		}

		/* Asegura que el código tenga un espacio mínimo */
		code[class*="language-"] {
			min-height: 100%;
			display: inline-block;
			min-width: 100%;
			padding: 0 5px;
		}
	</style>

</head>

<body>

	<!--==================================================-->
	<!--Start dreamit testimonial Area-->
	<!--==================================================-->
	
	<div class="blog-area style-four pt-90 pb-85">
		<div class="container">
			<div class="row">
				<div class="col-sm-2"></div>
				<div class="col-lg-8 col-md-12">
					<div class="row">
						<div class="col-lg-12 detalle-post">
							<div class="dreamit-blog-single-box"></div>
						</div>
					</div>

					<div class="contact_area style-two pt-10">
						<div class="container">
							<div class="row">
								<div class="col-lg-12">
									<div class="contact_from style-two">
										<div class="contact_title pb-10">

											<div class="dreamit-section-bar mb-20"></div>
										</div>


									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-sm-2"></div>
			</div>
		</div>
	</div>
	<script>
		const API_BASE_URL = 'http://localhost:8000/api/v1';
		$(function () {
			const urlParams = new URLSearchParams(window.location.search);
			const itemId = urlParams.get('id');
			const itemType = urlParams.get('type');

			if (itemId) {
				cargarDetalleItem(itemId, itemType);
			} else {
				// window.location.href = 'index.html';
			}
		});

		async function cargarDetalleItem(id, type) {
			try {
				const endpoint = type === 'post' ? 'posts' : 'projects';
				const response = await fetch(`${API_BASE_URL}/${endpoint}/${id}`);

				if (!response.ok) {
					throw new Error('Item no encontrado');
				}

				const item = await response.json();

				const fecha = new Date(item.created_at).toLocaleDateString('es-ES', {
					year: 'numeric',
					month: 'long',
					day: 'numeric'
				});

				const quote = extractQuote(item.content);
				const quoteBlock = quote ? `
            <div class="wow fadeInUp" data-wow-delay="1s" data-wow-duration="1s">
                <div class="block-quoet">
                    <p>"${quote}"</p>
                    <span>Admin</span>
                </div>
            </div>
        ` : '';

				// Insertar el HTML inicial
				const detalleHtml = `
            <div class="dreamit-blog-single-box">
                <div class="dreamit-single-thumb">
                    <img src="${item.featured_image || 'assets/images/default-blog.jpg'}" 
                         alt="${item.title}"
                         style="width: 100%; height: 500px; object-fit: cover;">
                    <div class="post-catagoris">
                        <a href="#">${item.category ? item.category.name : 'Sin categoría'}</a>
                    </div>
                </div>
                <div class="dreamit-blog-content">
                    <div class="blog-meta-box">
                        <a href="#"><i class="fa fa-user"></i><span>Admin</span></a>
                        <span><i class="fa fa-calendar"></i><span>${fecha}</span></span>
                        <span><i class="far fa-comments"></i><span> 0 comment</span></span>
                    </div>
                    <div class="blog-title">
                        <h2>${item.title}</h2>
                    </div>
                    ${quoteBlock}
                    <div class="blog-content-text post-content">
                        ${item.content}
                    </div>
                </div>
            </div>
        `;

				// Insertar el contenido en el DOM
				$('.detalle-post').html(detalleHtml);

				// Procesar los bloques de código después de insertar el contenido
				procesarBloquesCodigo();

				// Actualizar título
				document.title = item.title;

			} catch (error) {
				console.error('Error:', error);
				alertify.error('Error al cargar el contenido');
			}
		}
		function extractQuote(content) {
			// Crear un elemento temporal para trabajar con el HTML
			const temp = document.createElement('div');
			temp.innerHTML = content;

			// Obtener solo el texto, excluyendo el HTML
			const textContent = temp.textContent || temp.innerText;

			// Buscar texto entre comillas que no siga a un signo =
			// Usamos negative lookbehind (?<!...) para excluir comillas que siguen a =
			const matches = textContent.match(/(?<!=)"([^"]*?)"/g);

			return matches ? matches[0].replace(/"/g, '') : null;
		}

		document.addEventListener('DOMContentLoaded', function () {
			// Envolver todos los bloques de código en un contenedor
			document.querySelectorAll('pre[class*="language-"]').forEach(function (block) {
				const container = document.createElement('div');
				container.className = 'code-block-container';
				block.parentNode.insertBefore(container, block);
				container.appendChild(block);

				// Agregar botón de copiar
				const button = document.createElement('button');
				button.className = 'copy-button';
				button.textContent = 'Copiar';
				container.appendChild(button);

				// Funcionalidad de copiar
				button.addEventListener('click', function () {
					const code = block.textContent;
					navigator.clipboard.writeText(code).then(function () {
						button.textContent = 'Copiado!';
						setTimeout(function () {
							button.textContent = 'Copiar';
						}, 2000);
					}).catch(function (err) {
						console.error('Error al copiar:', err);
						button.textContent = 'Error';
					});
				});
			});
		});
		function procesarBloquesCodigo() {
			// Mapa de nombres de lenguajes para mostrar
			const languageNames = {
				'javascript': 'JavaScript',
				'python': 'Python',
				'php': 'PHP',
				'css': 'CSS',
				'html': 'HTML',
				'java': 'Java',
				'sql': 'SQL',
				'typescript': 'TypeScript',
				'bash': 'Bash',
				'json': 'JSON'
			};

			document.querySelectorAll('pre').forEach(block => {
				// Obtener el lenguaje de la clase original antes de modificarla
				const originalClass = block.className;
				const languageMatch = originalClass.match(/language-(\w+)/);
				const language = languageMatch ? languageMatch[1].toLowerCase() : 'javascript';
				const displayName = languageNames[language] || 'Código';

				// Asegurarse de que tenga la clase para JavaScript
				block.className = 'language-javascript';
				if (block.querySelector('code')) {
					block.querySelector('code').className = 'language-javascript';
				}

				// Crear contenedor si no existe
				if (!block.parentElement.classList.contains('code-container')) {
					const container = document.createElement('div');
					container.className = 'code-container';
					block.parentNode.insertBefore(container, block);
					container.appendChild(block);

					// Agregar etiqueta de lenguaje
					const languageLabel = document.createElement('span');
					languageLabel.className = 'language-label';
					languageLabel.textContent = displayName;
					container.appendChild(languageLabel);

					// Agregar botón de copiar
					const copyButton = document.createElement('button');
					copyButton.className = 'copy-button';
					copyButton.textContent = 'Copiar';
					container.appendChild(copyButton);

					// Funcionalidad de copiar
					copyButton.addEventListener('click', async () => {
						try {
							const code = block.textContent;
							await navigator.clipboard.writeText(code);
							copyButton.textContent = '¡Copiado!';
							setTimeout(() => {
								copyButton.textContent = 'Copiar';
							}, 2000);
						} catch (err) {
							console.error('Error al copiar:', err);
							copyButton.textContent = 'Error';
						}
					});
				}
			});

			// Aplicar el resaltado
			Prism.highlightAll();
		}
	</script>
	<!--==================================================-->
	<!-- Start Search Popup Area -->
	<!--==================================================-->
	<!-- jquery js -->
	<script src="./assets/js/vendor/jquery-3.2.1.min.js"></script>
	<!-- bootstrap js -->
	<script src="./assets/js/bootstrap.min.js"></script>
	<!-- carousel js -->
	<script src="./assets/js/owl.carousel.min.js"></script>
	<!-- counterup js -->
	<script src="./assets/js/jquery.counterup.min.js"></script>
	<!-- waypoints js -->
	<script src="./assets/js/waypoints.min.js"></script>
	<!-- wow js -->
	<script src="./assets/js/wow.js"></script>
	<!-- imagesloaded js -->
	<script src="./assets/js/imagesloaded.pkgd.min.js"></script>
	<!-- venobox js -->
	<script src="./venobox/venobox.js"></script>
	<!-- ajax mail js -->
	<script src="./assets/js/tilt.jquery.min.js"></script>
	<script src="./assets/js/ajax-mail.js"></script>
	<!--  animated-text js -->
	<script src="./assets/js/animated-text.js"></script>
	<!-- venobox min js -->
	<script src="./venobox/venobox.min.js"></script>
	<!-- isotope js -->
	<script src="./assets/js/isotope.pkgd.min.js"></script>
	<!-- jquery nivo slider pack js -->
	<script src="./assets/js/jquery.nivo.slider.pack.js"></script>
	<!-- jquery meanmenu js -->
	<script src="./assets/js/jquery.meanmenu.js"></script>
	<script src="./assets/js/popper.min.js"></script>
	<!-- jquery scrollup js -->
	<script src="./assets/js/jquery.scrollUp.js"></script>
	<!-- theme js -->
	<script src="./assets/js/jquery.scrollUp.js"></script>
	<!-- Jquery UI js -->
	<script src="./assets/js/jquery-ui.min.js"></script>
	<!-- jquery js -->
	<script src="./assets/js/main.js"></script>
	<script src="./js/funcionesPlantillaBlog.js"></script>
</body>

</html>